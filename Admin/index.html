<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BEWISE ‚Äî Admin Dashboard</title>
<style>
  :root{
    --bg:#ffffff; --text:#000000; --muted:#6b7280;
    --green:#10b981; --green-dark:#059669; --card:#f8fafb;
    --shadow: 0 8px 20px rgba(15,23,42,0.06);
  }
  *{box-sizing:border-box;font-family:Inter, system-ui, Arial;}
  body{margin:0;background:var(--bg);color:var(--text);}
  .layout{display:flex;min-height:100vh;}
  aside{width:280px;padding:22px;border-right:1px solid #ececec;transition:transform 0.3s ease;}
  aside.hidden{transform:translateX(-100%);}
  .logo{width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--green),var(--green-dark));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;margin-bottom:12px;}
  nav{display:flex;flex-direction:column;gap:8px;}
  a.navlink{display:block;padding:10px;border-radius:10px;text-decoration:none;color:var(--text);font-weight:700;}
  a.navlink:hover{background:#f3f7f6;}
  .closeSidebar{display:none;cursor:pointer;font-size:24px;font-weight:900;text-align:right;margin-bottom:12px;}
  header{display:flex;justify-content:space-between;align-items:center;padding:18px 22px;border-bottom:1px solid #f0f2f3;}
  main{flex:1;padding:22px;}
  .metrics{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:18px;}
  .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);}
  .btn{padding:8px 12px;border-radius:8px;border:0;background:var(--green);color:#fff;font-weight:800;cursor:pointer;}
  .btn.ghost{background:transparent;border:2px solid var(--green);color:var(--green);}
  .search{padding:8px 10px;border-radius:8px;border:1px solid #e6e6e6;}
  table{width:100%;border-collapse:collapse;}
  th,td{padding:10px;border-bottom:1px solid #eee;text-align:left;}
  .error{color:red;font-size:13px;margin-top:6px;}
  .popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:18px 22px;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,0.2);display:none;z-index:1000;}
  .popup button{margin-top:12px;}
  .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);display:none;z-index:900;}
  .hamburger{display:none;cursor:pointer;font-size:24px;font-weight:900;user-select:none;}
  .tx-container{max-height:200px;overflow-y:auto;margin-top:12px;}
  @media(max-width:900px){
    aside{position:absolute;top:0;left:0;height:100%;background:var(--bg);z-index:800;}
    .hamburger{display:block;}
    .closeSidebar{display:block;}
    .metrics{grid-template-columns:repeat(2,1fr);}
  }
</style>
</head>
<body>

<div class="overlay" id="overlay"></div>
<div class="popup" id="popup">
  <div id="popupMessage"></div>
  <button onclick="closePopup()">Close</button>
</div>

<div class="layout">
  <aside id="sidebar">
    <div class="closeSidebar" id="closeSidebar">&times;</div>
    <div class="logo">B</div>
    <div style="font-weight:900">BEWISE Admin</div>
    <div style="color:var(--muted);font-size:13px;margin-bottom:12px">Crypto Trading & Fintech</div>
    <nav id="navlinks">
      <a class="navlink" href="index.html">üè† Dashboard</a>
      <a class="navlink" href="fraud.html">üõ°Ô∏è Fraud Detection</a>
      <a class="navlink" href="complaints.html">üì£ Customer Complaints</a>
      <a class="navlink" href="manual.html">üí∏ Manual Credit/Debit</a>
      <a class="navlink" href="kyc.html">ü™™ KYC Verification</a>
      <a class="navlink" href="monitoring.html">üìä Monitoring</a>
      <a class="navlink" href="control.html">‚öôÔ∏è Control Services</a>
      <a class="navlink" href="notifications.html">üîî Notifications</a>
      <a class="navlink" href="staff.html">üë• Staff Roles</a>
      <a class="navlink" href="logs.html">üìú Logs & Audits</a>
      <a class="navlink" href="scaling.html">üöÄ Business Scaling</a>
    </nav>
    <div style="margin-top:18px;color:var(--muted)">Logged in as <strong>Dubem</strong></div>
  </aside>

  <div style="flex:1">
    <header>
      <div style="display:flex;align-items:center;gap:8px;">
        <div class="hamburger" id="hamburger">&#9776;</div>
        <h1 style="margin:0">Admin Dashboard</h1>
      </div>
    </header>

    <main>
      <section class="metrics">
        <div class="card">
          <div style="font-size:12px;color:var(--muted)">Total Volume (24h)</div>
          <div style="font-size:20px;font-weight:900;margin-top:8px" id="vol">‚Ç¶0.00</div>
          <div class="error" id="volError"></div>
        </div>
        <div class="card">
          <div style="font-size:12px;color:var(--muted)">Deposits</div>
          <div style="font-size:20px;font-weight:900;margin-top:8px" id="dep">‚Ç¶0.00</div>
          <div class="error" id="depError"></div>
        </div>
        <div class="card">
          <div style="font-size:12px;color:var(--muted)">Withdrawals</div>
          <div style="font-size:20px;font-weight:900;margin-top:8px" id="wd">‚Ç¶0.00</div>
          <div class="error" id="wdError"></div>
        </div>
        <div class="card">
          <div style="font-size:12px;color:var(--muted)">Active Users</div>
          <div style="font-size:20px;font-weight:900;margin-top:8px" id="users">0</div>
          <div class="error" id="usersError"></div>
        </div>
      </section>

      <section class="card" style="margin-bottom:14px">
        <div>
          <h3 style="margin:0">Recent Transactions</h3>
          <div style="color:var(--muted);font-size:13px">Latest 5</div>
        </div>
        <div class="tx-container">
          <table>
            <thead><tr><th>Tx ID</th><th>From</th><th>To</th><th>Amount</th><th>Status</th><th>Date</th></tr></thead>
            <tbody id="txBody"><tr><td colspan="6">Loading...</td></tr></tbody>
          </table>
        </div>
        <div style="margin-top:6px;">
          <button class="btn" id="toggleTx">See More</button>
        </div>
        <div class="error" id="txError"></div>
      </section>
    </main>
  </div>
</div>

<script>
const BACKEND = "https://your-backend-url.com"; // replace with your backend
let allTx=[], showing=5;

// Hamburger toggle
const hamburger=document.getElementById('hamburger');
const sidebar=document.getElementById('sidebar');
const closeBtn=document.getElementById('closeSidebar');
hamburger.addEventListener('click',()=>{sidebar.classList.toggle('hidden');});
closeBtn.addEventListener('click',()=>{sidebar.classList.add('hidden');});

// Popups
const popup=document.getElementById('popup');
const overlay=document.getElementById('overlay');
function showPopup(msg){document.getElementById('popupMessage').innerText=msg;popup.style.display='block';overlay.style.display='block';}
function closePopup(){popup.style.display='none';overlay.style.display='none';}

// Load metrics
async function loadMetrics(){
  try{
    const res=await fetch(`${BACKEND}/admin/metrics`);
    const data=await res.json();
    if(data.status==="success"){
      document.getElementById('vol').innerText=`‚Ç¶${data.total_volume}`;
      document.getElementById('dep').innerText=`‚Ç¶${data.deposits}`;
      document.getElementById('wd').innerText=`‚Ç¶${data.withdrawals}`;
      document.getElementById('users').innerText=data.active_users;
    }else showPopup(data.message||"Error loading metrics");
  }catch(e){showPopup(e);}
}

// Load transactions
async function loadTx(){
  try{
    const res=await fetch(`${BACKEND}/admin/recent_tx`);
    const tx=await res.json();
    if(Array.isArray(tx)){allTx=tx;renderTx();}
    else showPopup(tx.message||"Unexpected response");
  }catch(e){showPopup(e);}
}

function renderTx(){
  const body=document.getElementById('txBody');
  const visible=allTx.slice(0,showing);
  body.innerHTML=visible.map(r=>`<tr>
    <td>${r.id}</td>
    <td>${r.type==="Transfer Out"?"Self":r.other_party}</td>
    <td>${r.other_party}</td>
    <td>‚Ç¶${r.amount}</td>
    <td>Success</td>
    <td>${r.date}</td>
  </tr>`).join("");

  const toggleBtn=document.getElementById('toggleTx');
  toggleBtn.innerText = showing>=allTx.length?"See Less":"See More";
}

document.getElementById('toggleTx').addEventListener('click',()=>{
  showing = showing>=allTx.length?5:allTx.length;
  renderTx();
});

loadMetrics();
loadTx();
</script>
</body>
</html>