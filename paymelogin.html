<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - PayMe</title>
<style>
body{font-family:Arial,sans-serif;background:#f7f7f7;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;}
.container{background:#fff;padding:20px;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,0.1);width:90%;max-width:400px;}
h2{text-align:center;color:#333;}
label{display:block;margin:10px 0 5px;}
input{width:100%;padding:10px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;}
button{width:100%;padding:10px;background:#5b4dff;color:#fff;border:none;border-radius:6px;cursor:pointer;}
#error{color:red;text-align:center;margin-bottom:10px;}
</style>
</head>
<body>
<div class="container">
<h2>Login</h2>
<div id="error"></div>
<label>Username / Phone / Account No</label>
<input type="text" id="identifier" placeholder="Enter username, phone or account">
<label>Password</label>
<input type="password" id="password" placeholder="Enter password">
<button id="loginBtn">Login</button>
<p style="text-align:center;margin-top:10px;">Don't have an account? <a href="payme_register.html">Register</a></p>
</div>

<script>
document.getElementById('loginBtn').addEventListener('click', async ()=>{
  const identifier = document.getElementById('identifier').value.trim();
  const password = document.getElementById('password').value.trim();
  const errorDiv = document.getElementById('error');
  errorDiv.innerText='';

  if(!identifier || !password){ errorDiv.innerText='All fields required'; return; }

  try{
    const res = await fetch('https://payme-6.onrender.com/login',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({identifier, password})
    });
    const data = await res.json();
    if(res.ok){
      localStorage.setItem('user', JSON.stringify(data.user));
      window.location.href='dashboard.html';
    } else { errorDiv.innerText=data.message; }
  } catch(err){ errorDiv.innerText='Network error'; }
});
</script>
</body>
</html>